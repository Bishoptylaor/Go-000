# 学习笔记
## 一、微服务概览

1. 单体架构：化繁为简，分而治之

2. 起源

   1. 最佳soa实践，面向服务的架构模式
   2. 小即是美，单一职责，可移植性大于效率

3. 定义

   1. 源自服务
   2. 独立进程
   3. 隔离部署
   4. 去中心化治理模式
   5. 基础设施建设要求复杂度高

4. 问题

   1. 分布式系统，数据维护，通信异常处理，rpc通信，
   2. 模块依赖，调用链等对业务更新的影响
   3. 运维要求高

5. 去中心化

   1. 数据
   2. 治理
   3. 技术

6. 基础设自动化

   1. *CICD**：**Gitlab + Gitlab Hooks + k8s*

   2. *Testing**：测试环境、单元测试、**API**自动化测试*

   3. *在线运行时：**k8s，**以及一系列* *Prometheus**、**ELK**、**Conrtol Panle*

      ![image-20201127202913431](/Users/bishop/Library/Application Support/typora-user-images/image-20201127202913431.png)

   4. 服务发现

7. 可用性 && 兼容性设计

   1. design for failure 思想
   2. 发送时要保守，接收时要开放。按照伯斯塔尔法则的思想来设计和实现服务时，发送的数据要更保守，意味着最小化的传送必要的信息，接收时更开放意味着要最大限度的容忍冗余数据，保证兼容性。



## 微服务设计

1. api gateway
   1. BFF （backend for frontend）可以认为是一种适配服务，将后端的微服务进行适配(主要包括聚合裁剪和格式适配等逻辑)，向无线端设备暴露友好和统一的 API，方便无线设备接入访问后端服务。
   2. 跨横切面(Cross-Cutting Concerns)的功能，需要协调更新框架升级发版(路由、认证、限流、安全)，因此全部上沉，引入了 *API Gateway*，把业务集成度高的 BFF 层和通用功能服务层 API Gateway 进行了分层处理。
   3. 